@page "/"

@using System.Threading;
@using CT.BusinessLogic.Interfaces

@inject ISerialService SerialService


<h1>Hello, world!</h1>


<h3>Serial ports says:</h3>

<div class="scale-monitor">
    <div class="digital-monitor net-weight grid-line" @onclick="GetValue">
        <div class="digital-monitor-center net-center">@ScaleValue</div>
    </div>
</div>


@code {
    private int Count { get; set; } = 100;
    Timer _updateTimer;
    public string ScaleValue { get; set; } = "0.000";

    protected override async Task OnInitializedAsync()
    {
        ScaleValue = await SerialService.GetSerialValue();
        _updateTimer = new Timer(state => { InvokeAsync(GetValue); }, null, 0, 100);
    }


    public async Task GetValue()
    {
        ScaleValue = await SerialService.GetSerialValue();
        await InvokeAsync(() => StateHasChanged());
    }

    public void Dispose()
    {
        _updateTimer.Dispose();
    }
}